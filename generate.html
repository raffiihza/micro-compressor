<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>QuadServ | Generate AI Image</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <a class="navbar-brand" href="#">QuadServ</a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNav"
        aria-controls="navbarNav"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="imagecompress.html" target="_blank"
              >Compress Image</a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="generate.html" target="_blank"
              >Generate AI Image</a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="llm.html" target="_blank"
              >Generate AI Text</a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="pdfcompress.html" target="_blank"
              >Compress PDF</a
            >
          </li>
        </ul>
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="about.html" target="_blank">About Us</a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link"
              href="https://github.com/raffiihza/micro-compressor"
              target="_blank"
              >GitHub Repo</a
            >
          </li>
        </ul>
      </div>
    </nav>
    <div class="container mt-3 mb-3">
      <div class="card">
        <div class="card-header">Generate Image with Stable Diffusion</div>
        <div class="card-body">
          <p class="card-text text-danger">
            <b>Please do not abuse this free service!</b>
          </p>

          <form id="prompt-form" class="mt-3">
            <div class="mb-3">
              <label for="prompt" class="form-label">Enter your prompt:</label>
              <input
                type="text"
                id="prompt"
                name="prompt"
                class="form-control"
                required
              />
            </div>
            <button type="submit" class="btn btn-primary">Generate</button>
            <p id="status" class="mt-2"></p>
          </form>

          <div id="image-container"></div>
          <script>
            const form = document.getElementById("prompt-form");
            const promptInput = document.getElementById("prompt");
            const statusText = document.getElementById("status");
            const imageContainer = document.getElementById("image-container");

            form.addEventListener("submit", async (event) => {
              event.preventDefault(); // Prevent default form submission

              statusText.textContent = "Loading...";

              const prompt = promptInput.value;

              const url = new URL("https://imageai.utseai.workers.dev");
              url.searchParams.append("prompt", prompt);

              try {
                const response = await fetch(url);
                if (!response.ok) {
                  throw new Error(`Error: ${response.statusText}`);
                }

                const blob = await response.blob();
                const imageUrl = URL.createObjectURL(blob);

                imageContainer.innerHTML = `<p><a href="${imageUrl}" download="GeneratedImage.png">Download Image</a></p><p><img src="${imageUrl}" alt="Generated Image" width="40%"></p>`;
              } catch (error) {
                statusText.textContent = `Error: ${error.message}`;
              } finally {
                statusText.textContent = "The image has been generated!";
              }
            });
          </script>
        </div>
      </div>
    </div>
  </body>
</html>
